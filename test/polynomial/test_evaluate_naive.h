#include "../../polynomial.h"

void test_evaluate_naive()
{
  {
    po::polynomial p{};
    assert(p() == 0);
  }

  {
    po::polynomial p{po::rank<0>{}};
    assert(p() == 0);
  }

  {
    po::polynomial p{0, po::rank<0>{}};
    assert(p() == 0);
  }

  {
    po::polynomial p{7.5, po::rank<0>{}};
    assert(p() == 7.5);
  }

  {
    po::polynomial p{po::rank<6>{}};
    assert(p(3, 2.3, -0.7, 3, 13.65, 5) == 0.);
  }

  {
    po::polynomial p{7.5, po::rank<6>{}};
    assert(p(3, 2.3, -0.7, 3, 13.65, 5) == 7.5);
  }

  {
    po::polynomial p
    ({
      { 1., {3, 0, 0}},
      {-4 , {1, 1, 0}},
      {-3 , {0, 0, 0}}
    });

    PO_ASSERT(p(3,2,1) == 0., p(3, 2, 1));

    // const double x[3] = {3, 2, 1};
    // assert(p(x) == 0.);
  }

  {
    po::polynomial p
    ({
      { 1., {3, 0, 0}},
      {-4 , {1, 1, 0}},
      {-3 , {0, 0, 0}},
      {2.5, {1, 0, 0}}
    });

    PO_ASSERT(p(3,2,1) == 7.5, p(3,2,1));

    // const double x[3] = {3, 2, 1};
    // assert(p(x) == 7.5);
  }

  {
    po::polynomial p
    ({
      { 1., {3, 0, 0, 7, 4, 1, 1, 7}},
      {-4 , {1, 1, 0, 5, 4, 1, 0, 0}},
      {-3 , {0, 0, 0, 0, 0, 3, 0, 0}},
    });

    PO_ASSERT(
      p(1.5,  1,  2,  1,   2.5,     2,  3,    2) ==
      1 * 3.375 * 1 * 1 * 1 * 39.0625 * 2 * 3 * 128   +
     -4 * 1.5   * 1 * 1 * 1 * 39.0625 * 2 * 1 *   1   +
     -3 * 1     * 1 * 1 * 1 *  1      * 8 * 1 *   1,
     p(1.5,  1,  2,  1,   2.5,     2,  3,    2));
  }

  {
    po::polynomial p
    ({
      { 1. , {3, 0, 0}},
      {-4  , {1, 1, 0}},
      { 3. , {0, 0, 2}},
      {-3  , {0, 0, 0}},
      { 2.5, {1, 0, 0}}
    });

    PO_ASSERT(p(3,2,1) ==
      1   * 27 * 1 * 1   +
     -4   *  3 * 2 * 1   +
      3   *  1 * 1 * 1   +
     -3   *  1 * 1 * 1   +
      2.5 *  3 * 1 * 1,
      p);

    // const po::point<3, double> x = {3, 2, 1};
    // assert(p(x) == 7.5 + 3.);
  }

  {
    po::polynomial p
    ({
      {-6. , {0, 5, 2}},
      { 1. , {3, 0, 0}},
      {-4  , {1, 1, 0}},
      { 3. , {0, 0, 2}},
      {-3  , {0, 0, 0}},
      { 2.5, {1, 0, 0}}
    });

    assert(p(3,2,1) ==
     -6   *  1 *32 * 1   +
      1   * 27 * 1 * 1   +
     -4   *  3 * 2 * 1   +
      3   *  1 * 1 * 1   +
     -3   *  1 * 1 * 1   +
      2.5 *  3 * 1 * 1);
  }

  PO_LINE;

}


